<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ninety Nine</title>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, Helvetica, sans-serif;
}

body {
  background: #f5c400;
  color: white;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ===== SCREENS ===== */
.screen {
  display: none;
  width: 100%;
  height: 100%;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

.active {
  display: flex;
}

/* ===== GO ===== */
#goBtn {
  width: 200px;
  height: 200px;
  border-radius: 50%;
  border: 6px solid white;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 48px;
  font-weight: bold;
  color: white;
}

/* ===== AD ===== */
#ad {
  font-size: 28px;
  text-align: center;
}

/* ===== GAME ===== */
#top {
  margin-bottom: 20px;
  text-align: center;
}

#time {
  font-size: 36px;
}

#info {
  margin-top: 10px;
  font-size: 20px;
}

#play {
  display: flex;
  gap: 40px;
}

/* ===== BUTTONS ===== */
.choice {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  border: 6px solid white;
  font-size: 72px;
  font-weight: bold;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0.5;
}

.choice.active {
  opacity: 1;
  background: rgba(255,255,255,0.2);
}

/* Perfect circle O */
#btnO {
  border-radius: 50%;
}

/* ===== RESULT ===== */
#winner {
  margin-top: 30px;
  font-size: 32px;
  text-align: center;
  position: relative;
}

/* Confetti (local) */
.confetti {
  position: absolute;
  width: 8px;
  height: 8px;
  background: white;
  animation: fall 1s linear infinite;
}

@keyframes fall {
  from { transform: translateY(0); opacity: 1; }
  to { transform: translateY(40px); opacity: 0; }
}
</style>
</head>

<body>

<!-- GO -->
<div id="go" class="screen active">
  <div id="goBtn" onclick="showAd()">GO!</div>
</div>

<!-- AD -->
<div id="adScreen" class="screen">
  <div id="ad">Publicidad<br><br>⏳ Esperá 5 segundos...</div>
</div>

<!-- GAME -->
<div id="game" class="screen">
  <div id="top">
    <div id="time">Tiempo: 15</div>
    <div id="info">O 0% | X 0%</div>
  </div>

  <div id="play">
    <div id="btnO" class="choice" onclick="vote('O')">○</div>
    <div id="btnX" class="choice" onclick="vote('X')">X</div>
  </div>

  <div id="winner"></div>
</div>

<script>
let time = 15;
let o = 0;
let x = 0;
let timer;
let userVote = null;

/* ===== FLOW ===== */
function showAd() {
  switchScreen("go", "adScreen");
  setTimeout(startGame, 5000);
}

function startGame() {
  switchScreen("adScreen", "game");
  startRound();
}

function switchScreen(hide, show) {
  document.getElementById(hide).classList.remove("active");
  document.getElementById(show).classList.add("active");
}

/* ===== GAME ===== */
function startRound() {
  time = 15;
  o = 0;
  x = 0;
  userVote = null;
  document.getElementById("winner").innerHTML = "";
  document.getElementById("btnO").classList.remove("active");
  document.getElementById("btnX").classList.remove("active");

  timer = setInterval(() => {
    time--;
    document.getElementById("time").textContent = "Tiempo: " + time;
    if (time === 0) endRound();
  }, 1000);
}

function vote(v) {
  if (time <= 0) return;
  if (userVote === v) return;

  if (userVote === "O") o--;
  if (userVote === "X") x--;

  if (v === "O") o++;
  if (v === "X") x++;

  userVote = v;

  document.getElementById("btnO").classList.remove("active");
  document.getElementById("btnX").classList.remove("active");

  document.getElementById(v === "O" ? "btnO" : "btnX").classList.add("active");

  updateInfo();
}

function updateInfo() {
  const total = o + x;
  if (total === 0) return;
  const oPct = Math.round((o / total) * 100);
  const xPct = 100 - oPct;
  document.getElementById("info").textContent = `O ${oPct}% | X ${xPct}%`;
}

function endRound() {
  clearInterval(timer);

  const total = o + x;
  if (total === 0) return;

  const oPct = o / total;
  const xPct = x / total;

  const winner = oPct < xPct ? "O" : "X";
  const pct = Math.round(Math.min(oPct, xPct) * 100);

  document.getElementById("winner").innerHTML =
    `WINNER<br>${winner}<br>${pct}%`;

  spawnConfetti();
}

/* ===== CONFETTI LOCAL ===== */
function spawnConfetti() {
  const w = document.getElementById("winner");
  for (let i = 0; i < 20; i++) {
    const c = document.createElement("div");
    c.className = "confetti";
    c.style.left = Math.random() * 100 + "%";
    c.style.top = "-10px";
    w.appendChild(c);
    setTimeout(() => c.remove(), 1000);
  }
}
</script>

</body>
</html>
