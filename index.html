<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ninety Nine</title>

<meta name="theme-color" content="#f5c400">

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, Helvetica, sans-serif;
}

body {
  background: #f5c400;
  color: white;
  height: 100vh;
  overflow: hidden;
}

/* ===== SCREENS ===== */
.screen {
  display: none;
  width: 100%;
  height: 100%;
}

.active {
  display: flex;
}

/* ===== GO ===== */
#goScreen {
  justify-content: center;
  align-items: center;
}

.go-circle {
  width: 180px;
  height: 180px;
  border-radius: 50%;
  background: white;
  color: #f5c400;
  font-size: 48px;
  font-weight: bold;
  display: flex;
  justify-content: center;
  align-items: center;
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.08); }
  100% { transform: scale(1); }
}

/* ===== AD ===== */
#adScreen {
  justify-content: center;
  align-items: center;
  pointer-events: none;
}

.ad-box {
  background: white;
  color: #f5c400;
  padding: 40px;
  border-radius: 20px;
  text-align: center;
  font-size: 24px;
}

/* ===== GAME ===== */
#game {
  flex-direction: column;
}

#top {
  height: 30%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

#time {
  font-size: 36px;
}

#play {
  flex: 1;
  display: flex;
}

.side {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
}

.button {
  width: 160px;
  height: 160px;
  border-radius: 50%;
  border: 5px solid white;
  font-size: 80px;
  font-weight: bold;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ===== WINNER ===== */
#winner {
  position: absolute;
  bottom: 40px;
  width: 100%;
  text-align: center;
  display: none;
}

#winnerText {
  font-size: 42px;
  font-weight: bold;
  animation: pop 0.4s ease;
}

#finalResult {
  font-size: 22px;
  margin-top: 10px;
}

@keyframes pop {
  0% { transform: scale(0.6); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

/* ===== CONFETTI ===== */
#confetti {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 999;
}
</style>
</head>

<body>

<!-- GO -->
<div id="goScreen" class="screen active">
  <div class="go-circle" onclick="startAd()">GO!</div>
</div>

<!-- AD -->
<div id="adScreen" class="screen">
  <div class="ad-box">
    Publicidad<br>
    <small>Comienza en <span id="adTime">5</span>s</small>
  </div>
</div>

<!-- GAME -->
<div id="game" class="screen">
  <div id="top">
    <div id="time">Tiempo: 15</div>
  </div>

  <div id="play">
    <div class="side">
      <div class="button" onclick="vote('O')">O</div>
    </div>
    <div class="side">
      <div class="button" onclick="vote('X')">X</div>
    </div>
  </div>

  <div id="winner">
    <div id="winnerText">WINNER</div>
    <div id="finalResult"></div>
  </div>
</div>

<canvas id="confetti"></canvas>

<script>
/* ===== AD ===== */
let adTime = 5;
let adTimer;

function startAd() {
  document.getElementById("goScreen").classList.remove("active");
  document.getElementById("adScreen").classList.add("active");
  adTime = 5;
  document.getElementById("adTime").textContent = adTime;

  adTimer = setInterval(() => {
    adTime--;
    document.getElementById("adTime").textContent = adTime;
    if (adTime === 0) {
      clearInterval(adTimer);
      startGame();
    }
  }, 1000);
}

/* ===== GAME ===== */
let time = 15;
let o = 0;
let x = 0;
let timer;

function startGame() {
  document.getElementById("adScreen").classList.remove("active");
  document.getElementById("game").classList.add("active");
  startRound();
}

function startRound() {
  time = 15;
  o = 0;
  x = 0;
  timer = setInterval(() => {
    time--;
    document.getElementById("time").textContent = "Tiempo: " + time;
    if (time === 0) endRound();
  }, 1000);
}

function vote(v) {
  if (v === "O") o++;
  else x++;
}

/* ===== END ===== */
function endRound() {
  clearInterval(timer);
  const total = o + x || 1;
  const oPct = Math.round((o / total) * 100);
  const xPct = 100 - oPct;

  document.getElementById("finalResult").textContent =
    `O ${oPct}% | X ${xPct}%`;

  document.getElementById("winner").style.display = "block";
  startConfetti();
}

/* ===== CONFETTI ===== */
const canvas = document.getElementById("confetti");
const ctx = canvas.getContext("2d");
let confettis = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

function startConfetti() {
  confettis = [];
  for (let i = 0; i < 120; i++) {
    confettis.push({
      x: Math.random() * canvas.width,
      y: Math.random() * -canvas.height,
      r: Math.random() * 6 + 4,
      d: Math.random() * 4 + 2,
      color: `hsl(${Math.random() * 360},100%,50%)`
    });
  }
  drawConfetti();
}

function drawConfetti() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  confettis.forEach(c => {
    ctx.beginPath();
    ctx.fillStyle = c.color;
    ctx.arc(c.x, c.y, c.r, 0, Math.PI * 2);
    ctx.fill();
    c.y += c.d;
    if (c.y < canvas.height) requestAnimationFrame(drawConfetti);
  });
}
</script>

</body>
</html>
